#!/bin/bash

SCRIPT_DIR=$(cd $(dirname "${BASH_SOURCE[0]}") && pwd)
source "${SCRIPT_DIR}/settings.sh"

LOG_FILE="${LOGS_DIR}/guess-php-profile-name-errors.log"
if [ ! -f "${LOG_FILE}" ]
then
    touch "${LOG_FILE}"
    chown http:http "${LOG_FILE}"
    chmod 770 "${LOG_FILE}"
fi

profile_name=$(jq -r .default.php "${WEB_STATION_HOME_DIR}/etc/WebStation.json" 2>>"${LOG_FILE}")
if [ $? -ne 0 ]
then
    echo "Failed identifying php profile name." >>"${LOG_FILE}"
    exit 1
fi

if [ -z "${profile_name}" ]
then
    echo "Invalid empty profile name found" >>"${LOG_FILE}"
    exit 2
fi

echo -n "${profile_name}"
