--- libsidplay/configure.ac	17 Jun 2006 14:56:26 -0000	1.9
+++ libsidplay/configure.ac	17 Dec 2006 07:43:54 -0000
@@ -5,14 +5,14 @@
 
 dnl Process this file with autoconf to produce a configure script.
 AC_INIT(libsidplay,2.LIBCUR.LIBREV)
-AC_CONFIG_HEADER(unix/config.h)
-AC_CONFIG_SRCDIR(Makefile.am)
-AC_CONFIG_AUX_DIR(unix)
-AM_INIT_AUTOMAKE(no-define)
+AC_CONFIG_HEADER([unix/config.h])
+AC_CONFIG_SRCDIR([Makefile.am])
+AC_CONFIG_AUX_DIR([unix])
+AM_INIT_AUTOMAKE([no-define])
 
 dnl libtool-style version-info number
 LIBVERSION=LIBCUR:LIBREV:LIBAGE
-AC_SUBST(LIBVERSION)
+AC_SUBST([LIBVERSION])
 
 AC_CANONICAL_HOST
 
@@ -27,36 +27,36 @@
 dnl Checks for header files.
 AC_HEADER_STDC
 dnl Check for AC99 headers
-AC_CHECK_HEADERS(stdbool.h)
-if test "$ac_cv_header_stdbool_h" = yes; then
-    MY_SUBST_DEF(SID_HAVE_STDBOOL_H)
+AC_CHECK_HEADERS([stdbool.h])
+if test "x$ac_cv_header_stdbool_h" = "xyes"; then
+    MY_SUBST_DEF([SID_HAVE_STDBOOL_H])
 else
-    MY_SUBST_UNDEF(SID_HAVE_STDBOOL_H)
+    MY_SUBST_UNDEF([SID_HAVE_STDBOOL_H])
 fi
-AC_CREATE_STDINT_H(unix/sidint.h)
+AC_CREATE_STDINT_H([unix/sidint.h])
 
 dnl Checks for typedefs, structures, and compiler characteristics.
 AC_C_BIGENDIAN
-if test $ac_cv_c_bigendian = yes; then
-    MY_SUBST(SID_WORDS_ENDIANESS,SID_WORDS_BIGENDIAN)
+if test "x$ac_cv_c_bigendian" = "xyes"; then
+    MY_SUBST([SID_WORDS_ENDIANESS],[SID_WORDS_BIGENDIAN])
 else
-    MY_SUBST(SID_WORDS_ENDIANESS,SID_WORDS_LITTLEENDIAN)
+    MY_SUBST([SID_WORDS_ENDIANESS],[SID_WORDS_LITTLEENDIAN])
 fi
 
-AC_CHECK_SIZEOF(char, 1)
-AC_CHECK_SIZEOF(short int, 2)
-AC_CHECK_SIZEOF(int, 4)
-AC_CHECK_SIZEOF(long int, 4)
-
-MY_SUBST(SID_SIZEOF_CHAR,$ac_cv_sizeof_char)
-MY_SUBST(SID_SIZEOF_SHORT_INT,$ac_cv_sizeof_short_int)
-MY_SUBST(SID_SIZEOF_INT,$ac_cv_sizeof_int)
-MY_SUBST(SID_SIZEOF_LONG_INT,$ac_cv_sizeof_long_int)
+AC_CHECK_SIZEOF([char], 1)
+AC_CHECK_SIZEOF([short int], 2)
+AC_CHECK_SIZEOF([int], 4)
+AC_CHECK_SIZEOF([long int], 4)
+
+MY_SUBST([SID_SIZEOF_CHAR],$ac_cv_sizeof_char)
+MY_SUBST([SID_SIZEOF_SHORT_INT],$ac_cv_sizeof_short_int)
+MY_SUBST([SID_SIZEOF_INT],$ac_cv_sizeof_int)
+MY_SUBST([SID_SIZEOF_LONG_INT],$ac_cv_sizeof_long_int)
 
 dnl Checks for library functions.
-AC_CHECK_FUNC(strncasecmp,[AC_DEFINE(HAVE_STRNCASECMP,,
+AC_CHECK_FUNC([strncasecmp],[AC_DEFINE(HAVE_STRNCASECMP,,
   [Define if you have the strncasecmp function.])],[])
-AC_CHECK_FUNC(strcasecmp,[AC_DEFINE(HAVE_STRCASECMP,,
+AC_CHECK_FUNC([strcasecmp],[AC_DEFINE(HAVE_STRCASECMP,,
   [Define if you have the strcasecmp function.])],[])
 
 AC_SYS_LONG_FILE_NAMES
@@ -65,15 +65,15 @@
 AC_LANG_CPLUSPLUS
 
 dnl Checks for C++ library functions.
-AC_CHECK_HEADER(sstream,[AC_DEFINE(HAVE_SSTREAM,,
+AC_CHECK_HEADER([sstream],[AC_DEFINE(HAVE_SSTREAM,,
   [Define if you have the <sstream> header file.])],[])
 
 dnl Check whether the compiler has bool.
 MY_CHECK_BOOL
-if test "$test_cv_have_bool" = yes; then
-    MY_SUBST_DEF(SID_HAVE_BOOL)
+if test "x$test_cv_have_bool" = "xyes"; then
+    MY_SUBST_DEF([SID_HAVE_BOOL])
 else
-    MY_SUBST_UNDEF(SID_HAVE_BOOL)
+    MY_SUBST_UNDEF([SID_HAVE_BOOL])
 fi
 
 dnl Check for exceptions.
@@ -89,7 +89,7 @@
         where the sid builder libraries are to be installed],
     [builders="$withval"]
 )
-AC_SUBST(builders)
+AC_SUBST([builders])
 
 dnl Email addresses
 AH_BOTTOM([/* Email addresses */
@@ -100,25 +100,25 @@
 CXXFLAGS="$CXXFLAGS -DHAVE_UNIX -I\$(top_srcdir)/include \
 -I\$(top_srcdir)/include/sidplay"
 ACLOCAL_AMFLAGS="-I unix"
-AC_SUBST(ACLOCAL_AMFLAGS)
+AC_SUBST([ACLOCAL_AMFLAGS])
 DEFAULT_INCLUDES=
-AC_SUBST(DEFAULT_INCLUDES)
+AC_SUBST([DEFAULT_INCLUDES])
 
-AC_OUTPUT(
-Makefile \
-include/Makefile \
-include/sidplay/Makefile \
-src/Makefile \
-src/c64/Makefile \
-src/mos6510/Makefile \
-src/mos6526/Makefile \
-src/mos656x/Makefile \
-src/sid6526/Makefile \
-src/sidtune/Makefile \
-src/xsid/Makefile \
-unix/Makefile \
-unix/libsidplay2.spec \
-unix/libsidplay2.qpg \
-unix/libsidplay2.pc \
-unix/sidconfig.h \
-)
+AC_OUTPUT([
+Makefile
+include/Makefile
+include/sidplay/Makefile
+src/Makefile
+src/c64/Makefile
+src/mos6510/Makefile
+src/mos6526/Makefile
+src/mos656x/Makefile
+src/sid6526/Makefile
+src/sidtune/Makefile
+src/xsid/Makefile
+unix/Makefile
+unix/libsidplay2.spec
+unix/libsidplay2.qpg
+unix/libsidplay2.pc
+unix/sidconfig.h
+])
--- libsidplay/unix/my_macros.m4	29 Nov 2005 22:56:47 -0000	1.8
+++ libsidplay/unix/my_macros.m4	17 Dec 2006 07:43:54 -0000
@@ -5,16 +5,15 @@
 dnl $3=found dir
 dnl [$4=found file]
 dnl -------------------------------------------------------------------------
-
 AC_DEFUN([MY_FIND_FILE],
 [
-    $3=NO
+    $3="NO"
     for i in $2; do
         for j in $1; do
             if test -r "$i/$j"; then
-                $3=$i
-                if test "$4" != ""; then
-                    $4=$j
+                $3="$i"
+                if test -n "$4"; then
+                    $4="$j"
                 fi
                 break 2
             fi
@@ -43,14 +42,10 @@
 ])
 
 
-
-
-
 dnl -------------------------------------------------------------------------
 dnl Check whether compiler has a working ``bool'' type.
 dnl Will substitute @HAVE_BOOL@ with either a def or undef line.
 dnl -------------------------------------------------------------------------
-
 AC_DEFUN([MY_CHECK_BOOL],
 [
     AC_MSG_CHECKING([for bool])
@@ -64,16 +59,16 @@
         )
     ])
     AC_MSG_RESULT($test_cv_have_bool)
-    if test "$test_cv_have_bool" = yes; then
+    if test "x$test_cv_have_bool" = "xyes"; then
         AC_DEFINE(HAVE_BOOL,,[Define if the C++ compiler supports BOOL])
     fi
 ])
 
+
 dnl -------------------------------------------------------------------------
 dnl Check whether C++ library has member ios::bin instead of ios::binary.
 dnl Will substitute @HAVE_IOS_BIN@ with either a def or undef line.
 dnl -------------------------------------------------------------------------
-
 AC_DEFUN([MY_CHECK_IOS_BIN],
 [
     AC_MSG_CHECKING([whether standard member ios::binary is available])
@@ -87,18 +82,18 @@
         )
     ])
     AC_MSG_RESULT($test_cv_have_ios_binary)
-    if test "$test_cv_have_ios_binary" = yes; then
+    if test "x$test_cv_have_ios_binary" = "xyes"; then
         AC_DEFINE(HAVE_IOS_BIN,,
             [Define if standard member ``ios::binary'' is called ``ios::bin''.]
         )
     fi
 ])
 
+
 dnl -------------------------------------------------------------------------
 dnl Check whether C++ library has member ios::bin instead of ios::binary.
 dnl Will substitute @HAVE_IOS_OPENMODE@ with either a def or undef line.
 dnl -------------------------------------------------------------------------
-
 AC_DEFUN([MY_CHECK_IOS_OPENMODE],
 [
     AC_MSG_CHECKING([whether standard member ios::openmode is available])
@@ -113,18 +108,18 @@
         )
     ])
     AC_MSG_RESULT($test_cv_have_ios_openmode)
-    if test "$test_cv_have_ios_openmode" = yes; then
+    if test "x$test_cv_have_ios_openmode" = "xyes"; then
         AC_DEFINE(HAVE_IOS_OPENMODE,,
             [Define if ``ios::openmode'' is supported.]
         )
     fi
 ])
 
+
 dnl -------------------------------------------------------------------------
 dnl Check whether C++ environment provides the "nothrow allocator".
 dnl Will substitute @HAVE_EXCEPTIONS@ if test code compiles.
 dnl -------------------------------------------------------------------------
-
 AC_DEFUN([MY_CHECK_EXCEPTIONS],
 [
     AC_MSG_CHECKING([whether exceptions are available])
@@ -138,13 +133,14 @@
         )
     ])
     AC_MSG_RESULT($test_cv_have_exceptions)
-    if test "$test_cv_have_exceptions" = yes; then
+    if test "x$test_cv_have_exceptions" = "xyes"; then
         AC_DEFINE(HAVE_EXCEPTIONS,,
             [Define if your C++ compiler implements exception-handling.]
         )
     fi
 ])
 
+
 dnl -------------------------------------------------------------------------
 dnl Library compile test using libtool
 dnl $1 = CXXFLAGS
@@ -184,8 +180,8 @@
     # Expand prefix/exec_prefix
     my_save_prefix="$prefix"
     my_save_exec_prefix="$exec_prefix"
-    test "x$prefix" = xNONE && prefix=$ac_default_prefix
-    test "x$exec_prefix" = xNONE && exec_prefix=$prefix
+    test "x$prefix" = "xNONE" && prefix=$ac_default_prefix
+    test "x$exec_prefix" = "xNONE" && exec_prefix=$prefix
     my_def_prefix=$prefix
     my_def_exec_prefix=$exec_prefix
     eval my_def_includedir=$includedir
@@ -206,7 +202,7 @@
 [
     dnl Find pkg-config
     AC_PATH_PROG(PKG_CONFIG, pkg-config, NO)
-    if test "$PKG_CONFIG" = NO; then
+    if test "x$PKG_CONFIG" = "xNO"; then
         AC_MSG_ERROR([
 pkg-config not found. See http://www.freedesktop.org/software/pkgconfig/
         ])
@@ -218,7 +214,7 @@
         ])
     fi
 
-    if test "$my_def_prefix" = ""; then
+    if test -z "$my_def_prefix"; then
         MY_EXPAND_PREFIX
     fi
 
@@ -245,7 +241,7 @@
 AC_DEFUN([MY_FIND_PKG_CONFIG_LIB],
 [
     dnl Check if pkg-config is configured
-    if test "$PKG_CONFIG" = ""; then
+    if test -z "$PKG_CONFIG"; then
         MY_CONFIG_PKG_CONFIG(0.5)
     fi
 
@@ -254,7 +250,7 @@
     dnl Be pessimistic.
     my_includedir=NO
     my_libdir=NO
-    my_uname=LIB`echo $1 | tr [[a-z]] [[A-Z]]`
+    my_uname=LIB`echo $1 | tr '[[a-z]]' '[[A-Z]]'`
 
     AC_ARG_WITH($1,
         [  --with-$1=DIR
@@ -276,7 +272,7 @@
     )
 
     # Find paths to headers & package config.
-    if test "$my_includedir" != NO; then
+    if test "x$my_includedir" != "xNO"; then
         my_dirs="$my_includedir $my_includedir/include"
         MY_FIND_FILE($4,$my_dirs,my_includedir,my_header)
     else
@@ -285,10 +281,10 @@
     fi
 
     dnl find libs
-    if test "$my_libdir" != NO; then
+    if test "x$my_libdir" != "xNO"; then
         my_dirs="$my_libdir $my_libdir/lib $my_libdir/src"
         MY_FIND_FILE(lib$1.la,$my_dirs,my_libdir)
-        if test "$my_libdir" = NO; then
+        if test "x$my_libdir" = "xNO"; then
             AC_MSG_ERROR([
 Unable to locate lib$1 library in:
     $my_dirs
@@ -318,10 +314,10 @@
     eval ${my_uname}_CXXFLAGS=\"$my_cxxflags\"
     eval ${my_uname}_LDFLAGS=\"$my_ldflags\"
 
-    if test "$3" != ""; then
+    if test -n "$3"; then
         my_vars="$3"
         for my_var in $my_vars; do
-            my_out=${my_uname}_`echo $my_var | tr [[a-z]] [[A-Z]]`
+            my_out=${my_uname}_`echo $my_var | tr '[[a-z]]' '[[A-Z]]'`
             eval $my_out=\`$PKG_CONFIG --variable=$my_var lib$1\`
         done
     fi
@@ -330,7 +326,7 @@
 
     dnl Check if found library works
     MY_TRY_COMPILE($my_cxxflags,$my_ldflags,$my_header,$5,my_works)
-    if test "$my_works" = NO; then
+    if test "x$my_works" = "xNO"; then
         AC_MSG_ERROR([
 $1 build test failed with found library and header files.
 Please check your installation!
@@ -338,7 +334,7 @@
     fi
 
     dnl Optional parameter - return used header
-    if test "$6" != ""; then
+    if test -n "$6"; then
         $6=$my_header
     fi
 
@@ -362,14 +358,14 @@
 [
     AC_MSG_CHECKING([for working $1 library and headers])
     
-    if test "$my_def_prefix" = ""; then
+    if test -z "$my_def_prefix"; then
         MY_EXPAND_PREFIX
     fi
 
     dnl Be pessimistic.
     my_libdir=""
     my_includedir=""
-    my_uname=LIB`echo $1 | tr [[a-z]] [[A-Z]]`
+    my_uname=LIB`echo $1 | tr '[[a-z]]' '[[A-Z]]'`
 
     AC_ARG_WITH($1,
         [  --with-$1=DIR
@@ -397,18 +393,18 @@
     my_works=NO
 
     # Use library path given by user (if any).
-    if test "$my_libdir" != ""; then
+    if test -n "$my_libdir"; then
         my_dirs="$my_libdir $my_libdir/lib $my_libdir/src"
         MY_FIND_FILE(lib$1.la,$my_dirs,my_libdir)
         my_ldflags="$my_libdir/lib$1.la"
     fi
 
-    if test "$my_libdir" != NO; then
+    if test "x$my_libdir" != "xNO"; then
         # Use include path given by user (if any).
-        if test "$my_includedir" != ""; then
+        if test -n "$my_includedir"; then
             my_dirs="$my_includedir $my_includedir/include"
             MY_FIND_FILE($4,$my_dirs,my_includedir,my_header)
-            if test "$my_includedir" != NO; then
+            if test "x$my_includedir" != "xNO"; then
                 my_cxxflags="-I$my_includedir"
                 # Run test compilation.
                 MY_TRY_COMPILE($my_cxxflags,$my_ldflags,$my_header,$5,my_works)
@@ -418,7 +414,7 @@
             # we find the correct one
             for i in $4; do
                 MY_TRY_COMPILE($my_cxxflags,$my_ldflags,$i,$5,my_works)
-                if test "$my_works" != NO; then
+                if test "x$my_works" != "xNO"; then
                     my_header="$i"
                     break
                 fi
@@ -426,7 +422,7 @@
         fi
     fi
 
-    if test "$my_works" = NO; then
+    if test "x$my_works" = "xNO"; then
         # Test compilation failed.
         # Need to search for library and headers
         # Search common locations where header files might be stored.
@@ -442,13 +438,13 @@
         MY_FIND_FILE(lib$1.la,$my_dirs,my_libdir)
         my_ldflags="$my_libdir/lib$1.la"
 
-        if test "$my_includedir" != NO && test "$my_libdir" != NO; then
+        if test "x$my_includedir" != "xNO" && test "x$my_libdir" != "xNO"; then
             # Test compilation with found paths.
             MY_TRY_COMPILE($my_cxxflags,$my_ldflags,$my_header,$5,my_works)
         fi
 
         AC_MSG_RESULT([library $my_libdir, headers $my_includedir])
-        if test "$my_works" = NO; then
+        if test "x$my_works" = "xNO"; then
             AC_MSG_ERROR([
 $1 build test failed with found library and header files.
 Please check your installation!
@@ -462,7 +458,7 @@
     eval ${my_uname}_LDFLAGS=\"$my_ldflags\"
 
     dnl Optional parameter - return used header
-    if test "$6" != ""; then
+    if test -n "$6"; then
         $6=$my_header
     fi
 ])
@@ -482,7 +478,7 @@
 
     my_libdir=""
     my_includedir=""
-    my_uname=LIB`echo $1 | tr [[a-z]] [[A-Z]]`
+    my_uname=LIB`echo $1 | tr '[[a-z]]' '[[A-Z]]'`
 
     AC_ARG_WITH($1-includes,
         [  --with-$1-includes=DIR
@@ -497,14 +493,14 @@
     )
 
     dnl Both paths must be provided
-    if test "$my_libdir" = ""; then
+    if test -z "$my_libdir"; then
         AC_MSG_RESULT(no)
         AC_MSG_ERROR([
 $1 library path not supplied!
         ])
     fi
 
-    if test "$my_includedir" = ""; then
+    if test -z "$my_includedir"; then
         AC_MSG_RESULT(no)
         AC_MSG_ERROR([
 $1 include path not supplied!
@@ -515,7 +511,7 @@
     my_dirs="$my_includedir"
     MY_FIND_FILE($2,$my_dirs,my_includedir,my_header)
 
-    if test "$my_includedir" = NO; then
+    if test "x$my_includedir" = "xNO"; then
         AC_MSG_RESULT(no)
         AC_MSG_ERROR([
 $1 headers not found!
@@ -527,7 +523,7 @@
     eval ${my_uname}_LDFLAGS=\"$my_libdir/lib$1.la\"
 
     dnl Optional parameter - return used header
-    if test "$3" != ""; then
-        $3=$my_header
+    if test -n "$3"; then
+        $3="$my_header"
     fi
 ])
